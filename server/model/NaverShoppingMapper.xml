<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="NaverShoppingMapper">  
  <select id="selectProductList">
    SELECT id, title, content
    , insert_user, DATE_FORMAT(insert_date , '%Y-%m-%d %H:%i:%S' ) as insert_date
    FROM react.board
    <if test='searchData != null and searchData != ""'>
    where content  like concat('%',#{searchData} , '%')
    </if>
  </select>

  <select id="selectBoardListPage">
    SELECT R1.* FROM(	
      select id, title, content, insert_user
      , DATE_FORMAT(insert_date , '%Y-%m-%d %H:%i:%S' ) as insert_date 
      from react.board a
      <if test='searchData != null and searchData != ""'>
      where content  like concat('%',#{searchData} , '%')
      </if>
      order by id
    ) R1
    LIMIT ${length} OFFSET ${start}	
  </select>

  <select id="selectBoardListCount">
    SELECT count(id) total_count
    FROM react.board a
    <if test='searchData != null and searchData != ""'>
      where content  like concat('%',#{searchData} , '%')
    </if>
  </select>

  <insert id="insertBoard">
    INSERT INTO react.board
    (id, title, content, insert_user, insert_date)
    VALUES(
      concat(DATE_FORMAT(now(), '%Y%m%d'),'ORDER',lpad(nextval('BOARD'),6,0))
      , #{title}, #{content}, #{insert_user}, now())
  </insert>

  <update id="updateBoard">
    UPDATE react.board
    SET title= #{title},
    content= #{content}
    WHERE id = #{id}
  </update>

  <delete id="deleteBoard">
    DELETE
    FROM react.board
    WHERE id = #{id}
  </delete>
</mapper>